
name: $(GITVERSION_FullSemVer)

trigger:
  branches:
    include:
      - master
      - feature/*
  paths:
    include:
      - '*'
    exclude:
     - 'azure-pipelines.yml'




pool:
  vmImage: 'windows-latest'

variables:
  buildConfiguration: 'Release'
  projects: 'Unai/Unai.csproj'
  GitVersion.SemVer: ''

steps:


- task: GitVersion@5
  inputs:
    runtime: 'core'
    configFilePath: 'GitVersion.yml'
    updateAssemblyInfo: true


- task: DotNetCoreCLI@2
  inputs:
    command: 'restore'
    feedsToUse: 'select'
    projects: '$(projects)' 
    vstsFeed: 'ff478692-09f4-406d-8d3e-4566cb81b0db'
    includeNuGetOrg: false
    versioningScheme: byBuildNumber

- task: DotNetCoreCLI@2 
  displayName: 'dotnet build' 
  inputs: 
    projects: '$(projects)' 
    arguments: '--configuration $(BuildConfiguration) /p:Version=$(GitVersion.SemVer)' 
    versioningScheme: byBuildNumber


- task: DotNetCoreCLI@2
  displayName: 'dotnet pack' 
  inputs: 
    command: pack
    packagesToPack: '$(projects)' 
    nobuild: true 
    versioningScheme: byEnvVar 
    versionEnvVar: GitVersion.SemVer

- task: DotNetCoreCLI@2 
  displayName: 'dotnet nuget push' 
  inputs: 
    command: push 
    publishVstsFeed: 'ff478692-09f4-406d-8d3e-4566cb81b0db' 
    versioningScheme: byBuildNumber